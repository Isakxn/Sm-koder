<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <style>
      .light {
        background-color: rgb(182, 153, 124);
        height: 100px;
        width: 100px;
      }
      .dark {
        background-color: rgb(84, 59, 36);
        height: 100px;
        width: 100px;
      }
      .light.red {
        background-color: rgba(206, 102, 102, 0.732);
        height: 100px;
        width: 100px;
      }
      .dark.red {
        background-color: rgb(127, 53, 53);
        height: 100px;
        width: 100px;
      }
      #chessboard td {
        text-align: center;
      }

      button {
        border: 0;
        background-color: rgb(255, 255, 255);
        height: 100px;
        width: 100px;
        align-content: center;
      }
    </style>
    <!-- The <table> HTML element represents tabular dataâ€”that is, information presented in
         a two-dimensional table comprised of rows and columns of cells containing data-->
    <table id="chessboard"></table>
    <table>
      <button onclick="rookButton()">
        <img style="height: 75px; width: 75px" src="./bilder/chessrook.png" />
      </button>
      <button onclick="bishopButton()">
        <img style="height: 75px; width: 75px" src="./bilder/chessbishop.png" />
      </button>
      <button onclick="queenButton()">
        <img style="height: 75px; width: 75px" src="./bilder/chessqueen.png" />
      </button>
    </table>

    <script>
      //Upgraded the array to a 2d array for easier access to positions
      let rook = false;
      let bishop = false;
      let queen = true;
      function OnClick() {
        console.log("klikked!!!!!");
      }
      function rookButton() {
        rook = true;
        bishop = false;
        queen = false;
      }
      function bishopButton() {
        bishop = true;
        rook = false;
        queen = false;
      }
      function queenButton() {
        queen = true;
        bishop = false;
        rook = false;
        console.log(queen, bishop, rook);
      }

      function drawtiles() {
        for (let i = 0; i < 8; i++) {
          const chessboard = document.getElementById("chessboard");
          //divides every row
          //The <tr> HTML element defines a row of cells in a table. The row's cells
          // can then be established using a mix of <td> (data cell) and <th> (header cell) elements.
          const addRow = document.createElement("tr");
          //creates an unique id for every row.
          addRow.id = `rowid${i}`;
          for (let u = 0; u < 8; u++) {
            //The <td> HTML element defines a cell of a table that contains data
            //  and may be used as a child of the <tr> element.
            const addTile = document.createElement("td");
            //I dont remember why i needed () =>.
            addTile.onclick = (event) => {
              console.log(event.currentTarget);
              //removes the " - " and seperates the x and y
              let position = event.currentTarget.id.split(`-`);
              //Create an loop for x and the y.
              for (let x = 0; x < 8; x++) {
                for (let y = 0; y < 8; y++) {
                  const clearId = `${x}-${y}`;
                  const element = document.getElementById(clearId);
                  element.classList.remove("red");
                  element.innerHTML = "";
                }
              }
              if (rook === true || queen === true) {
                for (let x = 0; x < 8; x++) {
                  const rowId = `${x}-${position[1]}`;
                  const rowElement = document.getElementById(rowId);
                  rowElement.classList.add("red");
                  const colid = `${position[0]}-${x}`;
                  const colElement = document.getElementById(colid);
                  colElement.classList.add("red");
                }
              }

              //Find the x y coordinates and finds the diagonal tile next to the position
              // ?. means if the element is undefined, also the tile is not on the board
              // then it wont execute the function
              if (queen === true || bishop === true) {
                for (let x = 0; x < 8; x++) {
                  document
                    .getElementById(`${u + x}-${i + x}`)
                    ?.classList.add("red"); // If element is NOT "undefined", add "red" to classList
                  document
                    .getElementById(`${u + x}-${i - x}`)
                    ?.classList.add("red"); // If element is NOT "undefined", add "red" to classList
                  document
                    .getElementById(`${u - x}-${i + x}`)
                    ?.classList.add("red"); // If element is NOT "undefined", add "red" to classList
                  document
                    .getElementById(`${u - x}-${i - x}`)
                    ?.classList.add("red"); // If element is NOT "undefined", add "red" to classList
                }
              }

              if (rook === true) {
                //adds the rook image
                event.currentTarget.innerHTML = `<img style = " height: 75px; width: 75px;" src = "./bilder/chessrook.png">`;
              }
              if (bishop === true) {
                event.currentTarget.innerHTML = `<img style = " height: 75px; width: 75px;" src = "./bilder/chessbishop.png">`;
              }
              if (queen === true) {
                event.currentTarget.innerHTML = `<img style = " height: 75px; width: 75px;" src = "./bilder/chessqueen.png">`;
              }
              console.log(event.currentTarget);
              OnClick();
            };

            addTile.id = `${u}-${i}`;
            // if (x + y / 2 = 0 ) (x y = u i) the tile is even and become dark.
            // otherwise it becomes light.
            if ((u + i) % 2 === 0) {
              addTile.classList.add("dark");
            } else {
              addTile.classList.add("light");
            }
            addRow.appendChild(addTile);
          }
          chessboard.appendChild(addRow);
        }

        console.log(chessboard);
      }

      drawtiles();
    </script>
  </body>
</html>
